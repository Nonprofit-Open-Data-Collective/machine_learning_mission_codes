met.n
View(dat2)
dat2$intermet <- ifelse(dat2$MET2013!=dat2$MIGMET131&dat2$samehouse==0, dat2$PERWT, 0)
dat2$fborn <- ifelse(dat2$CITIZEN=="Not a citizen"|dat2$CITIZEN=="Naturalized citizen", 1, 0)
met <- aggregate(intermet~fborn+YEAR, data=dat2, FUN=sum)
met <- merge(met, aggregate(PERWT~fborn+YEAR, data=dat2, FUN=sum), by=c("fborn", "YEAR"))
met$interpct <- (met$intermet/met$PERWT)*100
met.f <- subset(met, fborn==1)
met.n <- subset(met, fborn==0)
met.f
met.n
plot(met.f$YEAR, met.f$interpct, pch=16, ylim=c(0, 15), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2)
par(new=T)
plot(met.n$YEAR, met.n$interpct, pch=15, ylim=c(0, 15), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
met$YEAR <- as.numeric(as.character(met$YEAR))
met.f <- subset(met, fborn==1)
met.n <- subset(met, fborn==0)
plot(met.f$YEAR, met.f$interpct, pch=16, ylim=c(0, 15), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2)
par(new=T)
plot(met.n$YEAR, met.n$interpct, pch=15, ylim=c(0, 15), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
table(dat$MIGRATE1)
dat2 <- subset(dat2, MIGRATE1D!="Abroad one year ago")
dat <- subset(dat, METRO!="Not in metropolitan area"&MIGTYPE1!="Not in metropolitan area")
dat <- subset(dat, MIGRATE1D!="Abroad one year ago")
dat$samehouse <- ifelse(dat$MIGRATE1D=="Same house", 1, 0)
dat$intermet <- ifelse(dat$MET2013!=dat$MIGMET131&dat$samehouse==0, dat$PERWT, 0)
dat$fborn <- ifelse(dat$CITIZEN=="Not a citizen"|dat$CITIZEN=="Naturalized citizen", 1, 0)
dat$withinpuma <- ifelse(dat$MIGRATE1D=="Different house, moved within state, within PUMA", dat$PERWT, 0)
dat$interpuma <- ifelse(dat$samehouse==0&dat$withinpuma==0, dat$PERWT, 0)
dat$withinstate <- ifelse(dat$MIGRATE1=="Moved within state", dat$PERWT, 0)
dat$interstate <- ifelse(dat$MIGRATE1=="Moved between states", dat$PERWT, 0)
met <- aggregate(intermet~fborn+YEAR, data=dat, FUN=sum)
met <- merge(met, aggregate(PERWT~fborn+YEAR, data=dat, FUN=sum), by=c("fborn", "YEAR"))
met <- merge(met, aggregate(withinpuma~fborn+YEAR, data=dat, FUN=sum), by=c("fborn", "YEAR"))
met <- merge(met, aggregate(interpuma~fborn+YEAR, data=dat, FUN=sum), by=c("fborn", "YEAR"))
met <- merge(met, aggregate(samehouse~fborn+YEAR, data=dat, FUN=sum), by=c("fborn", "YEAR"))
met <- merge(met, aggregate(withinstate~fborn+YEAR, data=dat, FUN=sum), by=c("fborn", "YEAR"))
met <- merge(met, aggregate(interstate~fborn+YEAR, data=dat, FUN=sum), by=c("fborn", "YEAR"))
dat$intramet <- ifelse(dat$intermet==0&dat$samehouse==0, dat$PERWT, 0)
met <- merge(met, aggregate(intramet~fborn+YEAR, data=dat, FUN=sum), by=c("fborn", "YEAR"))
met$intermetpct <- (met$intermet/met$PERWT)*100
met$intrametpct <- (met$intramet/met$PERWT)*100
met$interpumapct <- (met$interpuma/met$PERWT)*100
met$intrapumapct <- (met$withinpuma/met$PERWT)*100
met$withinstatepct <- (met$withinstate/met$PERWT)*100
met$interstatepct <- (met$interstate/met$PERWT)*100
met$samehousepct <- (met$samehouse/met$PERWT)*100
met$YEAR <- as.numeric(as.character(met$YEAR))
met.f <- subset(met, fborn==1)
met.n <- subset(met, fborn==0)
plot(met.f$YEAR, met.f$intrametpct, pch=16, ylim=c(0, 15), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2)
par(new=T)
plot(met.n$YEAR, met.n$intrametpct, pch=15, ylim=c(0, 15), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
plot(met.f$YEAR, met.f$samehousepct, pch=16, ylim=c(80, 95), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2)
par(new=T)
plot(met.n$YEAR, met.n$samehousepct, pch=15, ylim=c(80, 95), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
plot(met.f$YEAR, met.f$samehousepct, pch=16, ylim=c(60, 95), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2)
par(new=T)
plot(met.n$YEAR, met.n$samehousepct, pch=15, ylim=c(60, 95), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
met.f
plot(met.f$YEAR, met.f$samehousepct, pch=16, ylim=c(60, 95), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2)
par(new=T)
plot(met.n$YEAR, met.n$samehousepct, pch=15, ylim=c(60, 95), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
met$samehousepct <- (met$samehouse/met$PERWT)*100
plot(met.f$YEAR, met.f$samehousepct, pch=16, ylim=c(60, 95), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2)
par(new=T)
plot(met.n$YEAR, met.n$samehousepct, pch=15, ylim=c(60, 95), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
dat$samehouse <- ifelse(dat$MIGRATE1D=="Same house", dat$PERWT, 0)
met <- merge(met, aggregate(samehouse~fborn+YEAR, data=dat, FUN=sum), by=c("fborn", "YEAR"))
met$samehousepct <- (met$samehouse/met$PERWT)*100
plot(met.f$YEAR, met.f$samehousepct, pch=16, ylim=c(60, 95), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2)
par(new=T)
plot(met.n$YEAR, met.n$samehousepct, pch=15, ylim=c(60, 95), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
met
met$samehousepct <- (met$samehouse.x/met$PERWT)*100
plot(met.f$YEAR, met.f$samehousepct, pch=16, ylim=c(60, 95), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2)
par(new=T)
plot(met.n$YEAR, met.n$samehousepct, pch=15, ylim=c(60, 95), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
met.f <- subset(met, fborn==1)
met.n <- subset(met, fborn==0)
plot(met.f$YEAR, met.f$samehousepct, pch=16, ylim=c(60, 95), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2)
par(new=T)
plot(met.n$YEAR, met.n$samehousepct, pch=15, ylim=c(60, 95), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
met.n
met$samehousepct <- (met$samehouse.y/met$PERWT)*100
met.f <- subset(met, fborn==1)
met.n <- subset(met, fborn==0)
plot(met.f$YEAR, met.f$samehousepct, pch=16, ylim=c(60, 95), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2)
par(new=T)
plot(met.n$YEAR, met.n$samehousepct, pch=15, ylim=c(60, 95), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
plot(met.f$YEAR, met.f$samehousepct, pch=16, ylim=c(80, 95), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2)
par(new=T)
plot(met.n$YEAR, met.n$samehousepct, pch=15, ylim=c(80, 95), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
plot(met.f$YEAR, met.f$intermetpct, pch=16, ylim=c(0, 15), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2)
par(new=T)
plot(met.n$YEAR, met.n$intermetpct, pch=15, ylim=c(0, 15), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
plot(met.f$YEAR, met.f$intrametpct, pch=16, ylim=c(0, 15), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2)
par(new=T)
plot(met.n$YEAR, met.n$intrametpct, pch=15, ylim=c(0, 15), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
plot(met.f$YEAR, met.f$intermetpct, pch=16, ylim=c(0, 5), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2)
par(new=T)
plot(met.n$YEAR, met.n$intermetpct, pch=15, ylim=c(0, 5), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
plot(met.f$YEAR, met.f$intermetpct, pch=16, ylim=c(0, 6), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2)
par(new=T)
plot(met.n$YEAR, met.n$intermetpct, pch=15, ylim=c(0, 6), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
plot(met.f$YEAR, met.f$interpumapct, pch=16, ylim=c(0, 6), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2)
par(new=T)
plot(met.n$YEAR, met.n$interpumapct, pch=15, ylim=c(0, 6), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
plot(met.f$YEAR, met.f$interpumapct, pch=16, ylim=c(0, 15), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2)
par(new=T)
plot(met.n$YEAR, met.n$interpumapct, pch=15, ylim=c(0, 15), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
plot(met.f$YEAR, met.f$intrapumapct, pch=16, ylim=c(0, 15), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2)
par(new=T)
plot(met.n$YEAR, met.n$intrapumapct, pch=15, ylim=c(0, 15), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
met.f
plot(met.f$YEAR, met.f$interstatepct, pch=16, ylim=c(0, 15), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2)
par(new=T)
plot(met.n$YEAR, met.n$interstatepct, pch=15, ylim=c(0, 15), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
plot(met.f$YEAR, met.f$withinstatepct, pch=16, ylim=c(0, 15), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2)
par(new=T)
plot(met.n$YEAR, met.n$withinstatepct, pch=15, ylim=c(0, 15), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
plot(met.f$YEAR, met.f$samehousepct, pch=16, ylim=c(80, 95), ylab="Percentage of Stayers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Individuals Living in Same House")
par(new=T)
plot(met.n$YEAR, met.n$samehousepct, pch=15, ylim=c(80, 95), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
plot(met.f$YEAR, met.f$samehousepct, pch=16, ylim=c(80, 90), ylab="Percentage of Stayers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Individuals Living in Same House")
par(new=T)
plot(met.n$YEAR, met.n$samehousepct, pch=15, ylim=c(80, 95), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
legend(2014.5, 81.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
legend(2014.5, 81.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1.5, lty=2)
plot(met.f$YEAR, met.f$samehousepct, pch=16, ylim=c(80, 90), ylab="Percentage of Stayers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Individuals Living in Same House")
par(new=T)
plot(met.n$YEAR, met.n$samehousepct, pch=15, ylim=c(80, 95), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 82.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1.5, lty=2)
plot(met.f$YEAR, met.f$samehousepct, pch=16, ylim=c(80, 90), ylab="Percentage of Stayers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Adults Living in Same House")
par(new=T)
plot(met.n$YEAR, met.n$samehousepct, pch=15, ylim=c(80, 95), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 82.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1.5, lty=2)
plot(met.f$YEAR, met.f$intermetpct, pch=16, ylim=c(0, 6), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Adults Moving Between Metros")
par(new=T)
plot(met.n$YEAR, met.n$intermetpct, pch=15, ylim=c(0, 6), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
plot(met.f$YEAR, met.f$intermetpct, pch=16, ylim=c(0, 6), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Adults Moving Between Metros")
par(new=T)
plot(met.n$YEAR, met.n$intermetpct, pch=15, ylim=c(0, 6), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 1.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1.5, lty=2)
plot(met.f$YEAR, met.f$intrametpct, pch=16, ylim=c(0, 15), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Adults Moving Within Metros"))
par(new=T)
plot(met.n$YEAR, met.n$intrametpct, pch=15, ylim=c(0, 15), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1.5, lty=2)
plot(met.f$YEAR, met.f$intrametpct, pch=16, ylim=c(0, 15), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Adults Moving Within Metros"))
par(new=T)
plot(met.n$YEAR, met.n$intrametpct, pch=15, ylim=c(0, 15), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1.5, lty=2)
plot(met.f$YEAR, met.f$intrametpct, pch=16, ylim=c(0, 15), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Adults Moving Within Metros")
par(new=T)
plot(met.n$YEAR, met.n$intrametpct, pch=15, ylim=c(0, 15), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1.5, lty=2)
plot(met.f$YEAR, met.f$interpumapct, pch=16, ylim=c(0, 15), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Adults Moving Between PUMAs"))
par(new=T)
plot(met.n$YEAR, met.n$interpumapct, pch=15, ylim=c(0, 15), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1.5, lty=2)
plot(met.f$YEAR, met.f$interpumapct, pch=16, ylim=c(0, 15), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Adults Moving Between PUMAs")
par(new=T)
plot(met.n$YEAR, met.n$interpumapct, pch=15, ylim=c(0, 15), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1.5, lty=2)
plot(met.f$YEAR, met.f$intrapumapct, pch=16, ylim=c(0, 15), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Adults Moving Within PUMAs")
par(new=T)
plot(met.n$YEAR, met.n$intrapumapct, pch=15, ylim=c(0, 15), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1.5, lty=2)
plot(met.f$YEAR, met.f$interstatepct, pch=16, ylim=c(0, 15), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Adults Moving Between States")
par(new=T)
plot(met.n$YEAR, met.n$interstatepct, pch=15, ylim=c(0, 15), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1.5, lty=2)
plot(met.f$YEAR, met.f$withinstatepct, pch=16, ylim=c(0, 15), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Adults Moving Within States")
par(new=T)
plot(met.n$YEAR, met.n$withinstatepct, pch=15, ylim=c(0, 15), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1.5, lty=2)
plot(met.f$YEAR, met.f$withinstatepct, pch=16, ylim=c(0, 15), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Urban Adults Moving Within States")
par(new=T)
plot(met.n$YEAR, met.n$withinstatepct, pch=15, ylim=c(0, 15), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1.5, lty=2)
plot(met.f$YEAR, met.f$intrapumapct, pch=16, ylim=c(0, 15), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Urban Adults Moving Within PUMAs")
par(new=T)
plot(met.n$YEAR, met.n$intrapumapct, pch=15, ylim=c(0, 15), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1.5, lty=2)
plot(met.f$YEAR, met.f$interstatepct, pch=16, ylim=c(0, 15), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Urban Adults Moving Between States")
par(new=T)
plot(met.n$YEAR, met.n$interstatepct, pch=15, ylim=c(0, 15), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1.5, lty=2)
plot(met.f$YEAR, met.f$interstatepct, pch=16, ylim=c(0, 5), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Urban Adults Moving Between States")
par(new=T)
plot(met.n$YEAR, met.n$interstatepct, pch=15, ylim=c(0, 5), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 1.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1.5, lty=2)
plot(met.f$YEAR, met.f$interstatepct, pch=16, ylim=c(0, 6), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Urban Adults Moving Between States")
par(new=T)
plot(met.n$YEAR, met.n$interstatepct, pch=15, ylim=c(0, 6), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 1.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1.5, lty=2)
plot(met.f$YEAR, met.f$interpumapct, pch=16, ylim=c(0, 6), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Urban Adults Moving Between PUMAs")
par(new=T)
plot(met.n$YEAR, met.n$interpumapct, pch=15, ylim=c(0, 6), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 1.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1.5, lty=2)
plot(met.f$YEAR, met.f$intermetpct, pch=16, ylim=c(0, 6), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Urban Adults Moving Between Metros")
par(new=T)
plot(met.n$YEAR, met.n$intermetpct, pch=15, ylim=c(0, 6), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 1.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1.5, lty=2)
plot(met.f$YEAR, met.f$interpumapct, pch=16, ylim=c(0, 6), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Urban Adults Moving Between PUMAs")
par(new=T)
plot(met.n$YEAR, met.n$interpumapct, pch=15, ylim=c(0, 6), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 1.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1.5, lty=2)
pdf("~/Dropbox (ASU)/immig_mobility/New Analysis/Moving Graphs.pdf")
plot(met.f$YEAR, met.f$samehousepct, pch=16, ylim=c(80, 90), ylab="Percentage of Stayers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Urban Adults Living in Same House")
par(new=T)
plot(met.n$YEAR, met.n$samehousepct, pch=15, ylim=c(80, 95), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 82.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1.5, lty=2)
plot(met.f$YEAR, met.f$intermetpct, pch=16, ylim=c(0, 6), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Urban Adults Moving Between Metros")
par(new=T)
plot(met.n$YEAR, met.n$intermetpct, pch=15, ylim=c(0, 6), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 1.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1.5, lty=2)
plot(met.f$YEAR, met.f$intrametpct, pch=16, ylim=c(0, 15), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Urban Adults Moving Within Metros")
par(new=T)
plot(met.n$YEAR, met.n$intrametpct, pch=15, ylim=c(0, 15), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1.5, lty=2)
plot(met.f$YEAR, met.f$interpumapct, pch=16, ylim=c(0, 6), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Urban Adults Moving Between PUMAs")
par(new=T)
plot(met.n$YEAR, met.n$interpumapct, pch=15, ylim=c(0, 6), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 1.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1.5, lty=2)
plot(met.f$YEAR, met.f$intrapumapct, pch=16, ylim=c(0, 15), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Urban Adults Moving Within PUMAs")
par(new=T)
plot(met.n$YEAR, met.n$intrapumapct, pch=15, ylim=c(0, 15), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1.5, lty=2)
plot(met.f$YEAR, met.f$interstatepct, pch=16, ylim=c(0, 6), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Urban Adults Moving Between States")
par(new=T)
plot(met.n$YEAR, met.n$interstatepct, pch=15, ylim=c(0, 6), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 1.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1.5, lty=2)
plot(met.f$YEAR, met.f$withinstatepct, pch=16, ylim=c(0, 15), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Urban Adults Moving Within States")
par(new=T)
plot(met.n$YEAR, met.n$withinstatepct, pch=15, ylim=c(0, 15), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1.5, lty=2)
dev.off()
pdf("~/Dropbox (ASU)/immig_mobility/New Analysis/Moving Graphs.pdf")
plot(met.f$YEAR, met.f$samehousepct, pch=16, ylim=c(80, 90), ylab="Percentage of Stayers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Urban Adults Living in Same House")
par(new=T)
plot(met.n$YEAR, met.n$samehousepct, pch=15, ylim=c(80, 90), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 82.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
plot(met.f$YEAR, met.f$intermetpct, pch=16, ylim=c(0, 6), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Urban Adults Moving Between Metros")
par(new=T)
plot(met.n$YEAR, met.n$intermetpct, pch=15, ylim=c(0, 6), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 1.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
plot(met.f$YEAR, met.f$intrametpct, pch=16, ylim=c(0, 15), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Urban Adults Moving Within Metros")
par(new=T)
plot(met.n$YEAR, met.n$intrametpct, pch=15, ylim=c(0, 15), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
plot(met.f$YEAR, met.f$interpumapct, pch=16, ylim=c(0, 6), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Urban Adults Moving Between PUMAs")
par(new=T)
plot(met.n$YEAR, met.n$interpumapct, pch=15, ylim=c(0, 6), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 1.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
plot(met.f$YEAR, met.f$intrapumapct, pch=16, ylim=c(0, 15), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Urban Adults Moving Within PUMAs")
par(new=T)
plot(met.n$YEAR, met.n$intrapumapct, pch=15, ylim=c(0, 15), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
plot(met.f$YEAR, met.f$interstatepct, pch=16, ylim=c(0, 6), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Urban Adults Moving Between States")
par(new=T)
plot(met.n$YEAR, met.n$interstatepct, pch=15, ylim=c(0, 6), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 1.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
plot(met.f$YEAR, met.f$withinstatepct, pch=16, ylim=c(0, 15), ylab="Percentage of Movers", xlab="Year", cex=1.5, lty=2,
main="Percentage of Urban Adults Moving Within States")
par(new=T)
plot(met.n$YEAR, met.n$withinstatepct, pch=15, ylim=c(0, 15), ylab="", col="gray50", xlab="", cex=1.5, lty=2)
legend(2014.5, 5.5, legend=c("Foreign", "Native"), col=c("black", "gray50"), pch=c(16, 15), cex=1, lty=2)
dev.off()
setwd("~/Dropbox (ASU)/USC Mission Paper/Data and Analysis/Sample Framework/DATA")
setwd("~/Dropbox (ASU)/USC Mission Paper/Data and Analysis/github_files/machine_learning_mission_codes/DATA")
library(quanteda)
library(tm)
mission <- read.csv("MISSION.csv")
mission$uniqueID <- 1:nrow(mission)
mission.lim <- mission[, c("uniqueID","F9_03_PZ_MISSION")]
mission.lim <- data.frame(lapply(mission.lim, as.character), stringsAsFactors=FALSE)
### Quanteda and DFM
mission.corp <- corpus(mission.lim,
text_field = "F9_03_PZ_MISSION")
docid <- paste(mission$uniqueID)
docnames(mission.corp) <- docid
summary(mission.corp, 5)
metadoc(mission.corp, "docsource") <- "IRS EZ forms"
metadoc(mission.corp, "notes") <- "caveat emptor"
metadoc(mission.corp, "citation") <- "Lecy et. al,"
mission.corp
mission.corp[1]
summary(mission.corp)[1:10,]
## Have
mission.corp2 <- tolower(mission.corp)
mission.corp3 <- tokens(mission.corp2, remove_punct = TRUE)
mission.corp4 <- tokens_remove(tokens(mission.corp3), c(stopwords("english"), "nbsp"), padding  = T)
myNgram2 <- tokens(mission.corp4) %>%
tokens_ngrams(n = 2) %>%
dfm()
myNgram3 <- tokens(mission.corp4) %>%
tokens_ngrams(n = 3) %>%
dfm()
myNgram2miss.df <- textstat_frequency(myNgram2)
myNgram3miss.df <- textstat_frequency(myNgram3)
topfeatures(myNgram2)
topfeatures(myNgram3)
my_dict <- dictionary(list(five01_c_3= c("501 c 3","section 501 c") ,
united_states = "united states"))
mission.corp5 <- tokens_compound(mission.corp4, pattern = my_dict)
#mission.corp6 <- gsub("\\s+"," ", mission.corp5)
mission.corp6 <- sapply(mission.corp5, paste, collapse=c(" ", "  "))
mission.dfm <- dfm(mission.corp5,
stem = T)
mission.dfm2 <- dfm_trim(mission.dfm, sparsity = )
mission.dfm
topfeatures(mission.dfm, 20)
mission.dfm.df <- convert(mission.dfm, to = "data.frame")
mission.corpus.df <- as.data.frame(mission.corp6)
colnames(mission.corpus.df) <- "Corpus"
mission2 <- cbind(mission, mission.corpus.df)
mission3 <- cbind(mission2, mission.dfm.df)
write.csv(mission3, "Mission w Corpus and DFM.csv")
write.csv(mission.dfm.df, "~/Dropbox (ASU)/USC Mission Paper/Data and Analysis/Sample Framework/DATA/Mission DFM.csv")
write.csv(mission.corpus.df, "~/Dropbox (ASU)/USC Mission Paper/Data and Analysis/Sample Framework/DATA/Mission Corpus.csv")
### Programs
programs <- read.csv("PROGRAMS.csv")
programs.lim <- programs[, c("EIN","DESCRIPTION")]
programs.lim <- data.frame(lapply(programs.lim, as.character), stringsAsFactors=FALSE)
programs.corp <- corpus(programs.lim,
text_field = "DESCRIPTION")
docnames(programs.corp) <- docid
summary(programs.corp, 5)
programs.corp
programs.corp[1]
summary(programs.corp)[1:10,]
programs.corp2 <- tolower(programs.corp)
programs.corp3 <- tokens(programs.corp2, remove_punct = TRUE)
programs.corp4 <- tokens_remove(tokens(programs.corp3), stopwords("english"), padding  = F)
myNgram2 <- tokens(programs.corp4) %>%
tokens_ngrams(n = 2) %>%
dfm()
myNgram3 <- tokens(programs.corp4) %>%
tokens_ngrams(n = 3) %>%
dfm()
topfeatures(myNgram2)
topfeatures(myNgram3)
prog.ngrams <- rbind(myNgram2prog.df, myNgram3prog.df)
miss.ngrams <- rbind(myNgram2miss.df, myNgram3miss.df)
write.csv(prog.ngrams, "~/Dropbox (ASU)/USC Mission Paper/Data and Analysis/Sample Framework/DATA/Program Ngrams")
write.csv(miss.ngrams, "~/Dropbox (ASU)/USC Mission Paper/Data and Analysis/Sample Framework/DATA/Mission Ngrams")
my_dict <- dictionary(list(five01_c_3= c("501 c 3","section_501_c") ,
united_states = "united states"))
programs.corp5 <- tokens_compound(programs.corp4, pattern = my_dict)
programs.corp6 <- sapply(programs.corp5, paste, collaps=" ")
programs.dfm <- dfm(programs.corp6,
stem = T)
programs.dfm
topfeatures(programs.dfm, 20)
programs.dfm.df <- convert(programs.dfm, to = "data.frame")
programs.corpus.df <- as.data.frame(programs.corp6)
colnames(programs.corpus.df) <- "Corpus"
prog2 <- cbind(programs, programs.corpus.df)
prog3 <- cbind(prog2, programs.dfm.df)
mission.dfm.df <- convert(mission.dfm, to = "data.frame")
mission.corpus.df <- as.data.frame(mission.corp6)
colnames(mission.corpus.df) <- "Corpus"
mission2 <- cbind(mission, mission.corpus.df)
mission3 <- cbind(mission2, mission.dfm.df)
head(mission.corpus.df)
mission <- read.csv("MISSION.csv")
mission$uniqueID <- 1:nrow(mission)
mission.lim <- mission[, c("uniqueID","F9_03_PZ_MISSION")]
mission.lim <- data.frame(lapply(mission.lim, as.character), stringsAsFactors=FALSE)
### Quanteda and DFM
mission.corp <- corpus(mission.lim,
text_field = "F9_03_PZ_MISSION")
docid <- paste(mission$uniqueID)
docnames(mission.corp) <- docid
summary(mission.corp, 5)
metadoc(mission.corp, "docsource") <- "IRS EZ forms"
metadoc(mission.corp, "notes") <- "caveat emptor"
metadoc(mission.corp, "citation") <- "Lecy et. al,"
mission.corp
mission.corp[1]
summary(mission.corp)[1:10,]
## Have
mission.corp2 <- tolower(mission.corp)
mission.corp3 <- tokens(mission.corp2, remove_punct = TRUE)
mission.corp4 <- tokens_remove(tokens(mission.corp3), c(stopwords("english"), "nbsp"), padding  = F)
myNgram2 <- tokens(mission.corp4) %>%
tokens_ngrams(n = 2) %>%
dfm()
myNgram3 <- tokens(mission.corp4) %>%
tokens_ngrams(n = 3) %>%
dfm()
myNgram2miss.df <- textstat_frequency(myNgram2)
myNgram3miss.df <- textstat_frequency(myNgram3)
topfeatures(myNgram2)
topfeatures(myNgram3)
my_dict <- dictionary(list(five01_c_3= c("501 c 3","section 501 c") ,
united_states = "united states"))
mission.corp5 <- tokens_compound(mission.corp4, pattern = my_dict)
#mission.corp6 <- gsub("\\s+"," ", mission.corp5)
mission.corp6 <- sapply(mission.corp5, paste, collapse=c(" ", "  "))
mission.dfm <- dfm(mission.corp5,
stem = T)
mission.dfm2 <- dfm_trim(mission.dfm, sparsity = )
mission.dfm
topfeatures(mission.dfm, 20)
mission.dfm.df <- convert(mission.dfm, to = "data.frame")
mission.corpus.df <- as.data.frame(mission.corp6)
colnames(mission.corpus.df) <- "Corpus"
head(mission.corpus.df)
mission2 <- cbind(mission, mission.corpus.df)
mission3 <- cbind(mission2, mission.dfm.df)
write.csv(mission3, "Mission w Corpus and DFM.csv")
programs <- read.csv("PROGRAMS.csv")
programs.lim <- programs[, c("EIN","DESCRIPTION")]
programs.lim <- data.frame(lapply(programs.lim, as.character), stringsAsFactors=FALSE)
programs.corp <- corpus(programs.lim,
text_field = "DESCRIPTION")
docnames(programs.corp) <- docid
summary(programs.corp, 5)
programs.corp
programs.corp[1]
summary(programs.corp)[1:10,]
programs.corp2 <- tolower(programs.corp)
programs.corp3 <- tokens(programs.corp2, remove_punct = TRUE)
programs.corp4 <- tokens_remove(tokens(programs.corp3), stopwords("english"), padding  = F)
myNgram2 <- tokens(programs.corp4) %>%
tokens_ngrams(n = 2) %>%
dfm()
myNgram3 <- tokens(programs.corp4) %>%
tokens_ngrams(n = 3) %>%
dfm()
topfeatures(myNgram2)
topfeatures(myNgram3)
prog.ngrams <- rbind(myNgram2prog.df, myNgram3prog.df)
miss.ngrams <- rbind(myNgram2miss.df, myNgram3miss.df)
my_dict <- dictionary(list(five01_c_3= c("501 c 3","section_501_c") ,
united_states = "united states"))
programs.corp5 <- tokens_compound(programs.corp4, pattern = my_dict)
programs.corp6 <- sapply(programs.corp5, paste, collaps=" ")
programs.dfm <- dfm(programs.corp6,
stem = T)
programs.dfm
topfeatures(programs.dfm, 20)
programs.corp6 <- sapply(programs.corp5, paste, collaps=" ")
programs.corp5 <- tokens_compound(programs.corp4, pattern = my_dict)
programs.dfm <- dfm(programs.corp5,
stem = T)
programs.dfm
topfeatures(programs.dfm, 20)
programs.dfm.df <- convert(programs.dfm, to = "data.frame")
programs.corpus.df <- as.data.frame(programs.corp6)
colnames(programs.corpus.df) <- "Corpus"
head(programs.corpus.df$Corpus)
programs.corpus.df <- as.data.frame(programs.corp5)
