netwise$minority <-  ifelse(netwise$race_urm=="Underrepresented Minority", 1, 0)
netwise$hbcu <-  ifelse(netwise$institution_1==1, 1, 0)
netwise$womenscolleges <-  ifelse(netwise$institution_2==1, 1, 0)
netwise$masters  <-  ifelse(netwise$institution_3==1, 1, 0)
netwise$researchintensive  <-  ifelse(netwise$institution_4==1, 1, 0)
netwise$researchextensive <-  ifelse(netwise$institution_5==1, 1, 0)
netwise$liberalarts <-  ifelse(netwise$institution_6==1, 1, 0)
netwise$hsi  <-  ifelse(netwise$institution_7==1, 1, 0)
netwise$marriage  <-  ifelse(netwise$married_rc=="Married", 1, 0)
sat.dat <- netwise[, c( "citizen_foreign", "minority", "female","marriage",  "assistant", "associate", "loadpct_r3_c1", "loadavg",
"insttype",
"socialpotetency", "socialcloseness" ,
"worklifebalance_all",
"workstress_all",
"workinfluence_all",
"workdept_all",
"workminority_all",
"worksat_all" ,
"institution_city", "institution_state",
"hbcu", "womenscolleges", "masters",  "researchintensive",  "researchextensive"  , "liberalarts" , "hsi" )]
sat.dat <- na.omit(sat.dat)
summary(lm(worksat_all~socialcloseness+citizen_foreign+gender+married_rc+assistant+associate+race_urm+insttype+loadpct_r3_c1+loadpct_r3_c1+worklifebalance_all+workstress_all+workdept_all+workinfluence_all+workminority_all, data=sat.dat))
names(sat.dat)
table(netwise$ServicePositions_r1_c1)
table(netwise$servicepositions_r1_c1)
netwise$leadership <-  ifelse(netwise$servicepositions_r1_c1=="Checked", 1, 0)
sat.dat <- netwise[, c( "citizen_foreign", "minority", "female","marriage",  "assistant", "associate", "loadpct_r3_c1", "loadavg", "leadership",
"insttype",
"socialpotetency", "socialcloseness" ,
"worklifebalance_all",
"workstress_all",
"workinfluence_all",
"workdept_all",
"workminority_all",
"worksat_all" ,
"institution_city", "institution_state",
"hbcu", "womenscolleges", "masters",  "researchintensive",  "researchextensive"  , "liberalarts" , "hsi" )]
sat.dat <- na.omit(sat.dat)
summary(lm(worksat_all~socialpotetency+worklifebalance_all+workstress_all+workdept_all+workminority_all+workinfluence_all+leadership+
gender+assistant+associate+race_urm+loadpct_r3_c1, data=sat.dat))
summary(lm(worksat_all~socialpotetency+worklifebalance_all+workstress_all+workdept_all+workminority_all+workinfluence_all+leadership+
female+assistant+associate+race_urm+loadpct_r3_c1, data=sat.dat))
summary(lm(worksat_all~socialpotetency+worklifebalance_all+workstress_all+workdept_all+workminority_all+workinfluence_all+leadership+
female+assistant+associate+minority+loadpct_r3_c1, data=sat.dat))
summary(lm(worksat_all~socialpotetency+socialcloseness+worklifebalance_all+workstress_all+workdept_all+workminority_all+workinfluence_all+leadership+
female+assistant+associate+minority+loadpct_r3_c1, data=sat.dat))
summary(lm(worksat_all~socialpotetency+socialcloseness
+worklifebalance_all+workstress_all+workdept_all+workminority_all
+workinfluence_all+leadership+
citizen_foreign+
female+assistant+associate+minority+loadpct_r3_c1, data=sat.dat))
workstress_all <- netwise[, c("workstress_r1", "workstress_r2", "workstress_r3", "workstress_r4", "workstress_r5", "workstress_r6")]
psych::VSS.scree(cor(workstress_all))
workstress_all <- na.omit(workstress_all)
psych::VSS.scree(cor(workstress_all))
factanal(x = Particlim, factors = 2, rotation = "varimax")
factanal(x = workstress_all, factors = 2, rotation = "varimax")
fitAfterRotation <- factanal(workstress_all, factors = 2, rotation = "varimax")
print(fitAfterRotation$loadings, cutoff = .40, sort = TRUE)
print(fitAfterRotation$loadings, sort = TRUE)
alpha(workstress_all)
library(pysch)
install.packages("psych")
library(psych)
alpha(workstress_all)
workstress_all <- netwise[, c("workstress_r1", "workstress_r2", "workstress_r3", "workstress_r4", "workstress_r5", "workstress_r6")]
alpha(workstress_all)
worklifebalance_all <- netwise[, c("worklifebalance_r1", "worklifebalance_r2", "worklifebalance_r3", "worklifebalance_r4", "worklifebalance_r5")]
alpha(worklifebalance_all)
workdept_all <- netwise[, c("workdept_r1_rc_rev", "workdept_r2_rc_rev", "workdept_r3_rc_rev", "workdept_r4_rc_rev", "workdept_r5_rc_rev", "workdept_r6_rc_rev", "workdept_r7_rc_rev", "workdept_r8_rc_rev")]
workminority_all <- netwise[, c("workminority_r1_rc_rev", "workminority_r2_rc_rev", "workminority_r3_rc_rev", "workminority_r4_rc_rev", "workminority_r5_rc_rev", "workminority_r6_rc_rev", "workminority_r7_rc_rev")]
workdept_all <- netwise[, c("workdept_r1_rc_rev", "workdept_r2_rc_rev", "workdept_r3_rc_rev", "workdept_r4_rc_rev", "workdept_r5_rc_rev", "workdept_r6_rc_rev", "workdept_r7_rc_rev", "workdept_r8_rc_rev")]
alpha(workminority_all)
alpha(workdept_all)
head(workdept_all)
alpha(workdept_all, keys=c("workdept_r4_rc_rev", "workdept_r5_rc_rev", "workdept_r6_rc_rev", "workdept_r8_rc_rev"))
workinfluence_all <- netwise[, c("workinfluence_r1", "workinfluence_r2", "workinfluence_r3", "workinfluence_r4", "workinfluence_r5", "workinfluence_r6", "workinfluence_r7", "workinfluence_r8", "workinfluence_r9")]
workstress_all <- netwise[, c("workstress_r1", "workstress_r2", "workstress_r3", "workstress_r4", "workstress_r5", "workstress_r6")]
worklifebalance_all <- netwise[, c("worklifebalance_r1", "worklifebalance_r2", "worklifebalance_r3", "worklifebalance_r4", "worklifebalance_r5")]
workinfluence_all <- netwise[, c("workinfluence_r1", "workinfluence_r2", "workinfluence_r3", "workinfluence_r4", "workinfluence_r5", "workinfluence_r6", "workinfluence_r7", "workinfluence_r8", "workinfluence_r9")]
worksat_all <- netwise[, c("worksat_r1", "worksat_r2", "worksat_r3", "worksat_r4","worksat_r5","worksat_r6","worksat_r7","worksat_r8","worksat_r9","worksat_r10","worksat_r11","worksat_r12", "worksat_r13")]
workminority_all <- netwise[, c("workminority_r1_rc_rev", "workminority_r2_rc_rev", "workminority_r3_rc_rev", "workminority_r4_rc_rev", "workminority_r5_rc_rev", "workminority_r6_rc_rev", "workminority_r7_rc_rev")]
workdept_all <- netwise[, c("workdept_r1_rc_rev", "workdept_r2_rc_rev", "workdept_r3_rc_rev", "workdept_r4_rc_rev", "workdept_r5_rc_rev", "workdept_r6_rc_rev", "workdept_r7_rc_rev", "workdept_r8_rc_rev")]
alpha(workinfluence_all)
alpha(worksat_all)
library(lavaan)
library(foreign)
#setwd("~/Dropbox (ASU)/Foreign Born Experience/Active Data Cleaning/NETWISE II Data Cleaning")
netwise <- read.spss("~/Dropbox (ASU)/Foreign Born Experience/Data for Use/NET 2 clean data/Net2_ego_v1.sav", to.data.frame = T)
summery(netwise$socialcloseness)
formula <- worksat_all~socialpotetency+socialcloseness
+worklifebalance_all+workstress_all+workdept_all+workminority_all
+workinfluence_all+leadership+
female+assistant+associate+minority+loadpct_r3_c1
formula <- worksat_all~socialpotetency+socialcloseness
+worklifebalance_all+workstress_all+workdept_all+workminority_all
+workinfluence_all+leadership+
female+assistant+associate+minority+loadpct_r3_c1
results.e <-oaxaca(formula <- worksat_all~socialpotetency+socialcloseness
+worklifebalance_all+workstress_all+workdept_all+workminority_all
+workinfluence_all+leadership+
female+assistant+associate+minority+loadpct_r3_c1|citizen_foreign,
data=editor, reg.fun = glm)
library(oaxaca)
results.e <-oaxaca(formula <- worksat_all~socialpotetency+socialcloseness
+worklifebalance_all+workstress_all+workdept_all+workminority_all
+workinfluence_all+leadership+
female+assistant+associate+minority+loadpct_r3_c1|citizen_foreign,
data=editor, reg.fun = glm)
results.e <-oaxaca(formula <- worksat_all~socialpotetency+socialcloseness
+worklifebalance_all+workstress_all+workdept_all+workminority_all
+workinfluence_all+leadership+
female+assistant+associate+minority+loadpct_r3_c1|citizen_foreign,
data=sat.dat, reg.fun = glm)
plot(results.e, decomposition = "twofold", group.weight=-1,
unexplained.split = FALSE,
plot(results.e, decomposition = "twofold", group.weight=-1,
unexplained.split = FALSE)
plot(results.e, decomposition = "twofold", group.weight=-1,
unexplained.split = FALSE)
plot(results.e, decomposition = "twofold", group.weight=-1,
unexplained.split = FALSE)
results.e <-oaxaca(formula <- worksat_all~socialpotetency+socialcloseness
+worklifebalance_all+workstress_all+workdept_all+workminority_all
+workinfluence_all+leadership+
female+assistant+associate+loadpct_r3_c1|citizen_foreign,
data=sat.dat, reg.fun = glm)
plot(results.e, decomposition = "twofold", group.weight=-1,
unexplained.split = FALSE)
results.e <-oaxaca(formula <- worksat_all~socialpotetency+socialcloseness
+worklifebalance_all+workstress_all+workdept_all+workminority_all
+workinfluence_all+leadership+
female+assistant+associate+loadpct_r3_c1|citizen_foreign,
data=sat.dat, reg.fun = ols)
results.e <-oaxaca(formula <- worksat_all~socialpotetency+socialcloseness
+worklifebalance_all+workstress_all+workdept_all+workminority_all
+workinfluence_all+leadership+
female+assistant+associate+loadpct_r3_c1|citizen_foreign,
data=sat.dat, reg.fun = lm)
plot(results.e, decomposition = "twofold", group.weight=-1,
unexplained.split = FALSE)
plot(results.e, decomposition = "twofold", group.weight=-1,
unexplained.split = TRUE)
plot(results.e, decomposition = "threefold", group.weight=-1,
unexplained.split = FALSE)
table(netwise$insttype)
netwise2 <- subset(netwise, researchintensive==1|researchextensive==1)
netwise2 <- subset(netwise, researchintensive==1|researchextensive==1)
table(netwise$researchin)
table(netwise$researchintensive)
hu00 <- read.csv("~/Downloads/nhgis0028_csv/nhgis0028_ds151_2000_place.csv")
sat.dat <- netwise[, c( "citizen_foreign", "minority", "female","marriage",  "assistant", "associate", "loadpct_r3_c1", "loadavg", "leadership",
"insttype",
"socialpotetency", "socialcloseness" ,
"worklifebalance_all",
"workstress_all",
"workinfluence_all",
"workdept_all",
"workminority_all",
"worksat_all" ,
"hbcu", "womenscolleges", "masters",  "researchintensive",  "researchextensive"  , "liberalarts" , "hsi" )]
library(lavaan)
library(foreign)
#setwd("~/Dropbox (ASU)/Foreign Born Experience/Active Data Cleaning/NETWISE II Data Cleaning")
netwise <- read.spss("~/Dropbox (ASU)/Foreign Born Experience/Data for Use/NET 2 clean data/Net2_ego_v1.sav", to.data.frame = T)
#### World Life Balance
netwise$worklifebalance_r1 <- as.numeric(netwise$worklifebalance_r1)
netwise$worklifebalance_r2 <- as.numeric(netwise$worklifebalance_r2)
netwise$worklifebalance_r3 <- as.numeric(netwise$worklifebalance_r3)
netwise$worklifebalance_r4 <- as.numeric(netwise$worklifebalance_r4)
netwise$worklifebalance_r5 <- as.numeric(netwise$worklifebalance_r5)
netwise$worklifebalance_all <- netwise$worklifebalance_r1+netwise$worklifebalance_r2+netwise$worklifebalance_r3+netwise$worklifebalance_r4+netwise$worklifebalance_r5
summary(netwise$worklifebalance_all)
#### Work Stress
netwise$workstress_r1 <- as.numeric(netwise$workstress_r1)
netwise$workstress_r2 <- as.numeric(netwise$workstress_r2)
netwise$workstress_r3 <- as.numeric(netwise$workstress_r3)
netwise$workstress_r4 <- as.numeric(netwise$workstress_r4)
netwise$workstress_r5 <- as.numeric(netwise$workstress_r5)
netwise$workstress_r6 <- as.numeric(netwise$workstress_r6)
netwise$workstress_all <- netwise$workstress_r1+netwise$workstress_r2+netwise$workstress_r3+netwise$workstress_r4+netwise$workstress_r5+netwise$workstress_r6
summary(netwise$workstress_all)
#### Work Influence
netwise$workinfluence_r1 <- as.numeric(netwise$workinfluence_r1)
netwise$workinfluence_r2 <- as.numeric(netwise$workinfluence_r2)
netwise$workinfluence_r3 <- as.numeric(netwise$workinfluence_r3)
netwise$workinfluence_r4 <- as.numeric(netwise$workinfluence_r4)
netwise$workinfluence_r5 <- as.numeric(netwise$workinfluence_r5)
netwise$workinfluence_r6 <- as.numeric(netwise$workinfluence_r6)
netwise$workinfluence_r7 <- as.numeric(netwise$workinfluence_r7)
netwise$workinfluence_r8 <- as.numeric(netwise$workinfluence_r8)
netwise$workinfluence_r9 <- as.numeric(netwise$workinfluence_r9)
netwise$workinfluence_all <- netwise$workinfluence_r1+netwise$workinfluence_r2+netwise$workinfluence_r3+netwise$workinfluence_r4+netwise$workinfluence_r5+netwise$workinfluence_r6+netwise$workinfluence_r7+netwise$workinfluence_r8+netwise$workinfluence_r9
summary(netwise$workinfluence_all)
#### Department Culture
netwise$workdept_all <- netwise$workdept_r1_rc_rev+netwise$workdept_r2_rc_rev+netwise$workdept_r3_rc_rev+netwise$workdept_r4_rc_rev+netwise$workdept_r5_rc_rev+netwise$workdept_r6_rc_rev+netwise$workdept_r7_rc_rev+netwise$workdept_r8_rc_rev
summary(netwise$workdept_all)
netwise$workminority_all <- netwise$workminority_r1_rc_rev+netwise$workminority_r2_rc_rev+netwise$workminority_r3_rc_rev+netwise$workminority_r4_rc_rev+netwise$workminority_r5_rc_rev+netwise$workminority_r6_rc_rev+netwise$workminority_r7_rc_rev
summary(netwise$workminority_all)
#### Job Satisfaction
netwise$worksat_r1 <- as.numeric(netwise$worksat_r1)
netwise$worksat_r2 <- as.numeric(netwise$worksat_r2)
netwise$worksat_r3 <- as.numeric(netwise$worksat_r3)
netwise$worksat_r4 <- as.numeric(netwise$worksat_r4)
netwise$worksat_r5 <- as.numeric(netwise$worksat_r5)
netwise$worksat_r6 <- as.numeric(netwise$worksat_r6)
netwise$worksat_r7 <- as.numeric(netwise$worksat_r7)
netwise$worksat_r8 <- as.numeric(netwise$worksat_r8)
netwise$worksat_r9 <- as.numeric(netwise$worksat_r9)
netwise$worksat_r10 <- as.numeric(netwise$worksat_r10)
netwise$worksat_r11 <- as.numeric(netwise$worksat_r11)
netwise$worksat_r12 <- as.numeric(netwise$worksat_r12)
netwise$worksat_r13 <- as.numeric(netwise$worksat_r13)
netwise$worksat_all <- netwise$worksat_r1+netwise$worksat_r2+netwise$worksat_r3+netwise$worksat_r4+netwise$worksat_r5+netwise$worksat_r6+netwise$worksat_r7+netwise$worksat_r8+netwise$worksat_r9+netwise$worksat_r10+netwise$worksat_r11+netwise$worksat_r12+netwise$worksat_r13
summary(netwise$worksat_all)
netwise$assistant <- ifelse(netwise$position=="Assistant", 1, 0)
netwise$associate <- ifelse(netwise$position=="Associate", 1, 0)
netwise$full <- ifelse(netwise$position!="Assistant"&netwise$position!="Associate", 1, 0)
netwise$female <- ifelse(netwise$gender=="female", 1, 0)
netwise$minority <-  ifelse(netwise$race_urm=="Underrepresented Minority", 1, 0)
netwise$hbcu <-  ifelse(netwise$institution_1==1, 1, 0)
netwise$womenscolleges <-  ifelse(netwise$institution_2==1, 1, 0)
netwise$masters  <-  ifelse(netwise$institution_3==1, 1, 0)
netwise$researchintensive  <-  ifelse(netwise$institution_4==1, 1, 0)
netwise$researchextensive <-  ifelse(netwise$institution_5==1, 1, 0)
netwise$liberalarts <-  ifelse(netwise$institution_6==1, 1, 0)
netwise$hsi  <-  ifelse(netwise$institution_7==1, 1, 0)
netwise$marriage  <-  ifelse(netwise$married_rc=="Married", 1, 0)
netwise$leadership <-  ifelse(netwise$servicepositions_r1_c1=="Checked", 1, 0)
netwise2 <- subset(netwise, researchintensive==1|researchextensive==1)
sat.dat <- netwise[, c( "citizen_foreign", "minority", "female","marriage",  "assistant", "associate", "loadpct_r3_c1", "loadavg", "leadership",
"insttype",
"socialpotetency", "socialcloseness" ,
"worklifebalance_all",
"workstress_all",
"workinfluence_all",
"workdept_all",
"workminority_all",
"worksat_all")]
results.e <-oaxaca(formula <- worksat_all~socialpotetency+socialcloseness
+worklifebalance_all+workstress_all+workdept_all+workminority_all
+workinfluence_all+leadership+
female+assistant+associate+loadpct_r3_c1|citizen_foreign,
data=sat.dat, reg.fun = lm)
plot(results.e, decomposition = "threefold", group.weight=-1,
unexplained.split = FALSE)
sat.dat <- netwise2[, c( "citizen_foreign", "minority", "female","marriage",  "assistant", "associate", "loadpct_r3_c1", "loadavg", "leadership",
"insttype",
"socialpotetency", "socialcloseness" ,
"worklifebalance_all",
"workstress_all",
"workinfluence_all",
"workdept_all",
"workminority_all",
"worksat_all")]
results.e <-oaxaca(formula <- worksat_all~socialpotetency+socialcloseness
+worklifebalance_all+workstress_all+workdept_all+workminority_all
+workinfluence_all+leadership+
female+assistant+associate+loadpct_r3_c1|citizen_foreign,
data=sat.dat, reg.fun = lm)
head(sat.dat)
sat.dat <- na.omit(sat.dat)
results.e <-oaxaca(formula <- worksat_all~socialpotetency+socialcloseness
+worklifebalance_all+workstress_all+workdept_all+workminority_all
+workinfluence_all+leadership+
female+assistant+associate+loadpct_r3_c1|citizen_foreign,
data=sat.dat, reg.fun = lm)
plot(results.e, decomposition = "threefold", group.weight=-1,
unexplained.split = FALSE)
plot(results.e, decomposition = "twofold", group.weight=-1,
unexplained.split = FALSE)
sat.datF <- subset(sat.dat, citizen_foreign==1)
sat.datN <- subset(sat.dat, citizen_foreign==0)
summary(lm(worksat_all~socialpotetency+socialcloseness
+worklifebalance_all+workstress_all+workdept_all+workminority_all
+workinfluence_all+leadership+
female+assistant+associate+minority+loadpct_r3_c1, data=sat.datF))
summary(lm(worksat_all~socialpotetency+socialcloseness
+worklifebalance_all+workstress_all+workdept_all+workminority_all
+workinfluence_all+leadership+
female+assistant+associate+minority+loadpct_r3_c1, data=sat.datN))
library(foreign)
#setwd("~/Dropbox (ASU)/Foreign Born Experience/Active Data Cleaning/NETWISE II Data Cleaning")
netwise <- read.spss("~/Dropbox (ASU)/Foreign Born Experience/Data for Use/NET 2 clean data/Net2_ego_v1.sav", to.data.frame = T)
#### World Life Balance
netwise$worklifebalance_r1 <- as.numeric(netwise$worklifebalance_r1)
netwise$worklifebalance_r2 <- as.numeric(netwise$worklifebalance_r2)
netwise$worklifebalance_r3 <- as.numeric(netwise$worklifebalance_r3)
netwise$worklifebalance_r4 <- as.numeric(netwise$worklifebalance_r4)
netwise$worklifebalance_r5 <- as.numeric(netwise$worklifebalance_r5)
netwise$worklifebalance_all <- netwise$worklifebalance_r1+netwise$worklifebalance_r2+netwise$worklifebalance_r3+netwise$worklifebalance_r4+netwise$worklifebalance_r5
summary(netwise$worklifebalance_all)
#### Work Stress
netwise$workstress_r1 <- as.numeric(netwise$workstress_r1)
netwise$workstress_r2 <- as.numeric(netwise$workstress_r2)
netwise$workstress_r3 <- as.numeric(netwise$workstress_r3)
netwise$workstress_r4 <- as.numeric(netwise$workstress_r4)
netwise$workstress_r5 <- as.numeric(netwise$workstress_r5)
netwise$workstress_r6 <- as.numeric(netwise$workstress_r6)
netwise$workstress_all <- netwise$workstress_r1+netwise$workstress_r2+netwise$workstress_r3+netwise$workstress_r4+netwise$workstress_r5+netwise$workstress_r6
summary(netwise$workstress_all)
#### Work Influence
netwise$workinfluence_r1 <- as.numeric(netwise$workinfluence_r1)
netwise$workinfluence_r2 <- as.numeric(netwise$workinfluence_r2)
netwise$workinfluence_r3 <- as.numeric(netwise$workinfluence_r3)
netwise$workinfluence_r4 <- as.numeric(netwise$workinfluence_r4)
netwise$workinfluence_r5 <- as.numeric(netwise$workinfluence_r5)
netwise$workinfluence_r6 <- as.numeric(netwise$workinfluence_r6)
netwise$workinfluence_r7 <- as.numeric(netwise$workinfluence_r7)
netwise$workinfluence_r8 <- as.numeric(netwise$workinfluence_r8)
netwise$workinfluence_r9 <- as.numeric(netwise$workinfluence_r9)
netwise$workinfluence_all <- netwise$workinfluence_r1+netwise$workinfluence_r2+netwise$workinfluence_r3+netwise$workinfluence_r4+netwise$workinfluence_r5+netwise$workinfluence_r6+netwise$workinfluence_r7+netwise$workinfluence_r8+netwise$workinfluence_r9
summary(netwise$workinfluence_all)
#### Department Culture
netwise$workdept_all <- netwise$workdept_r1_rc_rev+netwise$workdept_r2_rc_rev+netwise$workdept_r3_rc_rev+netwise$workdept_r4_rc_rev+netwise$workdept_r5_rc_rev+netwise$workdept_r6_rc_rev+netwise$workdept_r7_rc_rev+netwise$workdept_r8_rc_rev
summary(netwise$workdept_all)
netwise$workminority_all <- netwise$workminority_r1_rc_rev+netwise$workminority_r2_rc_rev+netwise$workminority_r3_rc_rev+netwise$workminority_r4_rc_rev+netwise$workminority_r5_rc_rev+netwise$workminority_r6_rc_rev+netwise$workminority_r7_rc_rev
summary(netwise$workminority_all)
#### Job Satisfaction
netwise$worksat_r1 <- as.numeric(netwise$worksat_r1)
netwise$worksat_r2 <- as.numeric(netwise$worksat_r2)
netwise$worksat_r3 <- as.numeric(netwise$worksat_r3)
netwise$worksat_r4 <- as.numeric(netwise$worksat_r4)
netwise$worksat_r5 <- as.numeric(netwise$worksat_r5)
netwise$worksat_r6 <- as.numeric(netwise$worksat_r6)
netwise$worksat_r7 <- as.numeric(netwise$worksat_r7)
netwise$worksat_r8 <- as.numeric(netwise$worksat_r8)
netwise$worksat_r9 <- as.numeric(netwise$worksat_r9)
netwise$worksat_r10 <- as.numeric(netwise$worksat_r10)
netwise$worksat_r11 <- as.numeric(netwise$worksat_r11)
netwise$worksat_r12 <- as.numeric(netwise$worksat_r12)
netwise$worksat_r13 <- as.numeric(netwise$worksat_r13)
netwise$worksat_all <- netwise$worksat_r1+netwise$worksat_r2+netwise$worksat_r3+netwise$worksat_r4+netwise$worksat_r5+netwise$worksat_r6+netwise$worksat_r7+netwise$worksat_r8+netwise$worksat_r9+netwise$worksat_r10+netwise$worksat_r11+netwise$worksat_r12+netwise$worksat_r13
summary(netwise$worksat_all)
netwise$assistant <- ifelse(netwise$position=="Assistant", 1, 0)
netwise$associate <- ifelse(netwise$position=="Associate", 1, 0)
netwise$full <- ifelse(netwise$position!="Assistant"&netwise$position!="Associate", 1, 0)
netwise$female <- ifelse(netwise$gender=="female", 1, 0)
netwise$minority <-  ifelse(netwise$race_urm=="Underrepresented Minority", 1, 0)
netwise$hbcu <-  ifelse(netwise$institution_1==1, 1, 0)
netwise$womenscolleges <-  ifelse(netwise$institution_2==1, 1, 0)
netwise$masters  <-  ifelse(netwise$institution_3==1, 1, 0)
netwise$researchintensive  <-  ifelse(netwise$institution_4==1, 1, 0)
netwise$researchextensive <-  ifelse(netwise$institution_5==1, 1, 0)
netwise$liberalarts <-  ifelse(netwise$institution_6==1, 1, 0)
netwise$hsi  <-  ifelse(netwise$institution_7==1, 1, 0)
netwise$marriage  <-  ifelse(netwise$married_rc=="Married", 1, 0)
netwise$leadership <-  ifelse(netwise$servicepositions_r1_c1=="Checked", 1, 0)
netwise2 <- subset(netwise, researchintensive==1|researchextensive==1)
table(netwise2$female, netwise2$worksat_all)
aggregate(netwise2$worksat_all~netwise2$female)
aggregate(netwise2$worksat_all~netwise2$female, FUN=mean)
install.packages("rjson")
library("rjson")
install.packages("quanteda")
library(qdap)
install.packages("qdap")
library(qdap)
library(quanteda)
install.packages('corpus')
speeches <- quanteda.corpora::data_corpus_sotu
install.packages("devtools")
install.packages("devtools")
library(devtools)
library(devtools)
devtools::install_github("quanteda/quanteda.corpora")
??devtools
remove.packages(devtools)
install.packages("devtools")
library(devtools)
setwd("~/Dropbox (ASU)/USC Mission Paper/Data and Analysis/github_files/machine_learning_mission_codes/DATA")
library(bartMachine)
dat <- read.csv("Mission w Corpus and DFM.csv")
names(dat)
dat.dfm <- dat[,119:4947]
??bart
library(BayesTree)
bart(dat.dfm, dat$Orgpurposereligious, dat.dfm)
dat.dfm <- as.matrix(dat[,119:4947])
bart(dat.dfm, dat$Orgpurposereligious, dat.dfm)
dat.dfm <- (dat[,119:4947])
dat.dfm.mtrx <- data.matrix(dat.dfm, rownames.force = T)
bart(dat.dfm.mtrx, dat$Orgpurposereligious, dat.dfm.mtrx)
dat.dfm.mtrx <- matrix(as.numeric(unlist(dat.dfm)),nrow=nrow(dat.dfm))
bart(dat.dfm.mtrx, dat$Orgpurposereligious, dat.dfm.mtrx)
bart1 <- bart(dat.dfm.mtrx, dat$Orgpurposereligious, dat.dfm.mtrx)
plot(bart1,
plquants=c(.05,.95), cols =c('blue','black'),
...)
plot(bart1,
plquants=c(.05,.95), cols =c('blue','black'))
summary(bart1)
dat$religious <- ifelse(dat$Orgpurposereligious==1, "Religious", "No")
bart2 <- bartMachine(dat.dfm, dat$religious, dat, verbose=T)
library(bartMachine)
bart2 <- bartMachine(dat.dfm, dat$religious, dat, verbose=T)
plot(bart1)
library(sample_n)
install.packages("sample_n")
library(dplyr)
dat.test<- sample_n(dat, 345)
dat.dfm <- (dat.test[,119:4947])
dat.dfm.mtrx <- matrix(as.numeric(unlist(dat.dfm)),nrow=nrow(dat.dfm))
bart(dat.dfm.mtrx, dat$Orgpurposereligious, dat.dfm.mtrx)
dat.dfm <- cbind(dat.dfm, dat$religious)
dat.dfm <- cbind(dat.dfm, dat.test$religious)
bart(dat.dfm.mtrx, dat.test$religious, dat.dfm.mtrx)
dat.dfm <- (dat.test[,119:4947])
dat.dfm <- cbind(dat.dfm, dat.test$religious)
dat.dfm.mtrx <- matrix(as.numeric(unlist(dat.dfm)),nrow=nrow(dat.dfm))
bart(dat.dfm.mtrx, dat.dfm.mtrx$religious, dat.dfm.mtrx)
y.train <- dat.test$religious
dat.dfm <- (dat.test[,119:4947])
#dat.dfm <- cbind(dat.dfm, dat.test$religious)
y.train <- dat.test$religious
bart2 <- bart(dat.dfm.mtrx, y.train, dat)
dat.dfm <- (dat.test[,119:4947])
#dat.dfm <- cbind(dat.dfm, dat.test$religious)
y.train <- dat.test$religious
dat.dfm.mtrx <- matrix(as.numeric(unlist(dat.dfm)),nrow=nrow(dat.dfm))
bart2 <- bart(dat.dfm.mtrx, y.train, dat)
dat.mtrx <- matrix(as.numeric(unlist(dat)),nrow=nrow(dat))
bart2 <- bart(dat.dfm.mtrx, y.train, dat.mtrx)
y.train <- matrix(as.numeric(unlist(y.train)),nrow=nrow(y.train))
bart2 <- bart(dat.dfm.mtrx, y.train, dat.mtrx)
y.train <-dat.test <- dat.test[['religious']]
bart2 <- bart(dat.dfm.mtrx, y.train, dat.mtrx)
y.train <- matrix(as.numeric(unlist(y.train)),nrow=nrow(y.train))
View(y.train)
bart2 <- bart(dat.dfm.mtrx, y.train, dat.mtrx)
require(quanteda.corpora)
require(caret)
install.packages("caret")
install.packages("caret")
set.seed(300)
id_train <- sample(1:3446, 1000, replace = FALSE)
head(id_train, 10)
docvars(dat, "id_numeric") <- 1:ndoc(dat)
docvars(dat, "id_numeric") <- 1:nrow(dat)
library(quanteda)
docvars(dat, "id_numeric") <- 1:nrow(dat)
dat.corpus <- data.frame(lapply(dat, as.character), stringsAsFactors=FALSE)
dat.corpus <- corpus(dat.corpus,
text_field = "corpus")
dat.corpus <- corpus(dat.corpus,
text_field = "Corpus")
docvars(dat, "id_numeric") <- 1:nrow(dat)
docvars(dat.corpus, "id_numeric") <- 1:nrow(dat.corpus)
dat$id_numeric <- 1:nrow(dat)
dat.corpus <- data.frame(lapply(dat, as.character), stringsAsFactors=FALSE)
dat.corpus <- corpus(dat.corpus,
text_field = "Corpus")
dfmat_training <- corpus_subset(dat.corpus, id_numeric %in% id_train) %>%
dfm(stem = TRUE)
dfmat_test <- corpus_subset(dat.corpus, !id_numeric %in% id_train) %>%
dfm(stem = TRUE)
tmod_nb <- textmodel_nb(dfmat_training, docvars(dfmat_training, "Orgpurposereligious"))
summary(tmod_nb)
dfmat_matched <- dfm_match(dfmat_test, features = featnames(dfmat_training))
library(dfm_select)
actual_class <- docvars(dfmat_training, "Orgpurposereligious")
predicted_class <- predict(tmod_nb, newdata = dfmat_test)
dfmat_matched <- dfm_match(dfmat_test, features = featnames(dfmat_training))
dfmat_matched <- dfm_select(dfmat_test, features = featnames(dfmat_training))
??dfm_match
dfm_lookup(dfmat_test)
dfmat_matched <- dfm_select(dfmat_test, selection = "keep")
predicted_class <- predict(tmod_nb, newdata = dfmat_test)
predicted_class <- predict(tmod_nb, newdata = dfmat_matched)
predicted_class <- predict(tmod_nb, newdata = dfmat_matched)
predicted_class <- predict(tmod_nb, newdata = dfmat_matched)
predicted_class <- predict(tmod_nb, newdata = dfmat_matched)
predicted_class <- predict(tmod_nb, newdata = dfmat_matched)
predicted_class <- predict(tmod_nb, newdata = dfmat_matched)
dfmat_matched <- dfm_select(dfmat_test, selection = "keep", case_insensitive = FALSE, valuetype = "fixed")
actual_class <- docvars(dfmat_training, "Orgpurposereligious")
predicted_class <- predict(tmod_nb, newdata = dfmat_matched)
library(quanteda)
dfmat_matched <- dfm_match(dfmat_test, features = featnames(dfmat_training))
uninstall.packages("quanteda")
install.packages("quanteda")
library(bartMachine)
library(BayesTree)
library(dplyr)
library(quanteda.corpora)
library(caret)
library(quanteda)
dat <- read.csv("Mission w Corpus and DFM.csv")
set.seed(300)
id_train <- sample(1:3446, 1000, replace = FALSE)
head(id_train, 10)
dat$id_numeric <- 1:nrow(dat)
dat.corpus <- data.frame(lapply(dat, as.character), stringsAsFactors=FALSE)
dat.corpus <- corpus(dat.corpus,
text_field = "Corpus")
dfmat_training <- corpus_subset(dat.corpus, id_numeric %in% id_train) %>%
dfm(stem = TRUE)
# get test set (documents not in id_train)
dfmat_test <- corpus_subset(dat.corpus, !id_numeric %in% id_train) %>%
dfm(stem = TRUE)
tmod_nb <- textmodel_nb(dfmat_training, docvars(dfmat_training, "Orgpurposereligious"))
summary(tmod_nb)
dfmat_matched <- dfm_match(dfmat_test, features = featnames(dfmat_training))
dfmat_matched <- dfm_select(dfmat_test, selection = "keep", case_insensitive = FALSE, valuetype = "fixed")
actual_class <- docvars(dfmat_matched, "Orgpurposereligious")
predicted_class <- predict(tmod_nb, newdata = dfmat_matched)
dfmat_matched <- dfm_select(dfmat_test, pattern=dfmat_training, selection = "keep")
actual_class <- docvars(dfmat_matched, "Orgpurposereligious")
predicted_class <- predict(tmod_nb, newdata = dfmat_matched)
tab_class <- table(actual_class, predicted_class)
tab_class
confusionMatrix(tab_class, mode = "everything")
